System.register([],function(t,e){"use strict";var i,r,s=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});e&&e.id;return{setters:[],execute:function(){r=function(e){function t(){var t=e.call(this)||this;return t._uri=new URL(window.location.href),t._term=t.uri.searchParams.get("t"),t._filters=t._setFilters(t.uri.searchParams.getAll("f")),t._sort=t.uri.searchParams.get("s")||"relevance",t._qty=t.uri.searchParams.get("r"),t._init=!0,t._changeAttr=t._changeAttr.bind(t),t._popState=t._popState.bind(t),t}return s(t,e),Object.defineProperty(t.prototype,"uri",{get:function(){return this._uri},set:function(t){this._uri!==t&&(this._uri=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"term",{get:function(){var t=0<window.navigator.userAgent.indexOf("Trident/"),e=this._term;return t&&(e=e.replace("+"," ")),e},set:function(t){this._term!==t&&(this._term=t,this.uri.searchParams.set("t",this._term),this.setAttribute("term",this.term))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters},set:function(t){var e=this;this._filters=t,this.uri.searchParams.delete("f"),Object.keys(this._filters).forEach(function(t){e.uri.searchParams.append("f",t+"~"+e._filters[t].join(" "))})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sort",{get:function(){return this._sort},set:function(t){this._sort!==t&&(this._sort=t,this.uri.searchParams.set("s",this._sort),this.setAttribute("sort",this._sort))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"qty",{get:function(){return this._qty},set:function(t){this._qty!==t&&(this._qty=t,this.setAttribute("qty",this._sort))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"init",{get:function(){return this._init},set:function(t){this._init!==t&&(this._init=t)},enumerable:!0,configurable:!0}),t.prototype.connectedCallback=function(){top.addEventListener("search-complete",this._changeAttr),top.addEventListener("clear-filters",this._changeAttr),top.window.addEventListener("popstate",this._popState),this._paramsReady()},Object.defineProperty(t,"observedAttributes",{get:function(){return["sort","term","qty"]},enumerable:!0,configurable:!0}),t.prototype.attributeChangedCallback=function(t,e,r){this[t]=r},t.prototype._popState=function(t){this.uri=new URL(document.location.href),this.term=this.uri.searchParams.get("t")||null,this.filters=this._setFilters(this.uri.searchParams.getAll("f")),this.sort=this.uri.searchParams.get("s"),this.qty=this.uri.searchParams.get("r"),this._paramsReady()},t.prototype._paramsReady=function(){this.dispatchEvent(new CustomEvent("params-ready",{detail:{term:this.term,filters:this.filters,sort:this.sort,qty:this.qty},bubbles:!0}))},t.prototype._setFilters=function(t){var s={};return t.forEach(function(t){var e=t.split("~"),r=e[0],i=e[1].split(" ");s[r]=i}),s},t.prototype._changeAttr=function(t){switch(t.type){case"clear-filters":this.uri.searchParams.delete("f"),this.filters={};break;case"load-more":break;case"search-complete":t.detail&&void 0!==t.detail.term&&0<t.detail.term.length?this.term=t.detail.term:(this.term="",this.uri.searchParams.delete("t")),t.detail&&t.detail.filters&&(this.filters=t.detail.filters),t.detail&&void 0!==t.detail.sort&&(this.sort=t.detail.sort)}t.detail&&void 0===t.detail.invalid?history.pushState({},"RHDP Search: "+(this.term?this.term:""),""+this.uri.pathname+this.uri.search):(this.term="",this.filters={},this.sort="relevance",this.uri.searchParams.delete("t"),this.uri.searchParams.delete("f"),this.uri.searchParams.delete("s"),history.replaceState({},"RHDP Search Error",""+this.uri.pathname+this.uri.search))},t}(HTMLElement),t("default",r),customElements.define("rhdp-search-url",r)}}});