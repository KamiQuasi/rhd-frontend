System.register(["@rhd/rhdp-search/rhdp-search-filter-group","@rhd/rhdp-search/rhdp-search-filter-item"],function(e,t){"use strict";var r,p,h,i,n,s,l,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};t&&t.id;return{setters:[function(e){p=e},function(e){h=e}],execute:function(){i=function(t){function e(){var e=t.call(this)||this;return e._type="",e._title="Filter By",e._toggle=!1,e.modalTemplate=function(e,t){return'<div class="cover" id="cover">\n            <div class="title">'+t+' <a href="#" class="cancel" id="cancel">Close</a></div>\n            <div class="groups">\n            </div>\n            <div class="footer">\n            <a href="#" class="clearFilters">Clear Filters</a> \n            <a href="#" class="applyFilters">Apply</a>\n            </div>\n        </div>'},e.activeTemplate=function(e,t){return'<div class="active-type">\n        <strong>'+t+'</strong>\n        <div class="activeFilters"></div>\n        <a href="#" class="clearFilters">Clear Filters</a>\n      </div>'},e.template=function(e,t){return'<a class="showBtn">Show Filters</a>\n        <div class="control" id="control">\n            <div class="title">'+t+'</div>\n            <div class="groups">\n            </div>\n        </div>'},e._toggleModal=e._toggleModal.bind(e),e._clearFilters=e._clearFilters.bind(e),e._addFilters=e._addFilters.bind(e),e._checkActive=e._checkActive.bind(e),e}return o(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type!==e&&(this._type=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(e){this._title!==e&&(this._title=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return this._filters},set:function(e){this._filters!==e&&(this._filters=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toggle",{get:function(){return this._toggle},set:function(e){this._toggle!==e&&(this._toggle=e,this._toggle?(this.querySelector(".cover").className="cover modal",window.scrollTo(0,0),document.body.style.overflow="hidden",this.style.height=window.innerHeight+"px"):(this.querySelector(".cover").className="cover",document.body.style.overflow="auto"))},enumerable:!0,configurable:!0}),e.prototype.connectedCallback=function(){var t=this;"active"===this.type?(this.innerHTML=this.activeTemplate(n||(n=a(["",""],["",""])),this.title),top.addEventListener("filter-item-change",this._checkActive),top.addEventListener("filter-item-init",this._checkActive),top.addEventListener("search-complete",this._checkActive),top.addEventListener("params-ready",this._checkActive),top.addEventListener("clear-filters",this._clearFilters),this._addFilters()):("modal"===this.type?this.innerHTML=this.modalTemplate(s||(s=a(["",""],["",""])),this.title):this.innerHTML=this.template(l||(l=a(["",""],["",""])),this.title),this.addGroups()),this.addEventListener("click",function(e){switch(e.target.className){case"showBtn":case"cancel":case"applyFilters":e.preventDefault(),t.dispatchEvent(new CustomEvent("toggle-modal",{bubbles:!0}));break;case"clearFilters":e.preventDefault(),t.dispatchEvent(new CustomEvent("clear-filters",{bubbles:!0}));break;case"more":e.preventDefault()}}),top.addEventListener("toggle-modal",this._toggleModal)},Object.defineProperty(e,"observedAttributes",{get:function(){return["type","title","toggle"]},enumerable:!0,configurable:!0}),e.prototype.attributeChangedCallback=function(e,t,i){this[e]=i},e.prototype.addGroups=function(){for(var e=this.filters.facets,t=e.length,i=0;i<t;i++){var r=new p.default,n=e[i],s=r.querySelector(".group"),l=r.querySelector(".primary"),o=r.querySelector(".secondary"),a=n.items?n.items.length:0;a<=5&&s.removeChild(s.lastChild);for(var c=0;c<a;c++){var d=new h.default;d.name=n.items[c].name,d.value=n.items[c].value,d.active=n.items[c].active,d.key=n.items[c].key,d.group=n.key,c<5?l.appendChild(d):o.appendChild(d)}r.key=n.key,r.name=n.name,this.querySelector(".groups").appendChild(r)}},e.prototype._checkActive=function(e){e.detail&&(e.detail.facet?this.style.display=e.detail.facet.active?"block":this.style.display:0<this.querySelectorAll("rhdp-search-filter-item[active]").length?this.style.display="block":this.style.display="none")},e.prototype._initActive=function(e,i,r){return e.detail&&e.detail.filters&&Object.keys(e.detail.filters).forEach(function(t){e.detail.filters[t].forEach(function(e){if(t===i&&e===r.key)return!0})}),!1},e.prototype._addFilters=function(){for(var e=this.filters.facets,t=0;t<e.length;t++)for(var i=e[t].items,r=0;r<i.length;r++){var n=new h.default;n.name=i[r].name,n.value=i[r].value,n.inline=!0,n.bubble=!1,n.key=i[r].key,n.group=e[t].key,this.querySelector(".activeFilters").appendChild(n)}},e.prototype._toggleModal=function(e){"modal"===this.type&&(this.toggle=!this.toggle)},e.prototype.applyFilters=function(){this.dispatchEvent(new CustomEvent("apply-filters",{bubbles:!0}))},e.prototype._clearFilters=function(e){this.style.display="none"},e}(HTMLElement),e("default",i),customElements.define("rhdp-search-filters",i)}}});