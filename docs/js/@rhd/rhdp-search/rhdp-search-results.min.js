System.register(["@rhd/rhdp-search/rhdp-search-result"],function(t,e){"use strict";var i,s,r,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])})(t,e)},function(t,e){function s(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});e&&e.id;return{setters:[function(t){s=t}],execute:function(){r=function(e){function t(){var t=e.call(this)||this;return t._more=!1,t._last=0,t._valid=!0,t.invalidMsg=document.createElement("div"),t.loadMore=document.createElement("div"),t.endOfResults=document.createElement("div"),t.loading=document.createElement("div"),t._renderResults=t._renderResults.bind(t),t._setLoading=t._setLoading.bind(t),t._checkValid=t._checkValid.bind(t),t._clearResults=t._clearResults.bind(t),t}return n(t,e),Object.defineProperty(t.prototype,"results",{get:function(){return this._results},set:function(t){this._results!==t&&(this._results=t,this._renderResults(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"more",{get:function(){return this._more},set:function(t){this._more!==t&&(this._more=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function(){return this._last},set:function(t){this._last!==t&&(this._last=t||0,this.setAttribute("last",t.toString()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return this._valid},set:function(t){this._valid!==t&&(this._valid=t)},enumerable:!0,configurable:!0}),t.prototype.connectedCallback=function(){var e=this;this.invalidMsg.className="invalidMsg",this.invalidMsg.innerHTML="<h4>Well, this is awkward. No search term was entered yet, so this page is a little empty right now.</h4>\n        <p>After you enter a search term in the box above, you will see the results displayed here. \n        You can also use the filters to select a content type, product or topic to see some results too. Try it out!</p>",this.endOfResults.innerHTML='<p class="end-of-results">- End of Results -</p>',this.loadMore.className="moreBtn",this.loadMore.innerHTML='<a class="moreBtn" href="#">Load More</a>',this.loading.className="loading",this.loadMore.addEventListener("click",function(t){t.preventDefault(),e.dispatchEvent(new CustomEvent("load-more",{detail:{from:e.last},bubbles:!0}))}),top.addEventListener("search-complete",this._renderResults),top.addEventListener("search-start",this._setLoading),top.addEventListener("params-ready",this._checkValid),top.window.addEventListener("popstate",this._clearResults),this.addEventListener("load-more",function(t){e.more=!0})},t.prototype.addResult=function(t){var e=new s.default;e.result=t,this.appendChild(e)},t.prototype._setLoading=function(t){if(this.more)this.querySelector(".moreBtn")&&this.removeChild(this.loadMore),this.querySelector(".invalidMsg")&&this.removeChild(this.invalidMsg),this.more=!1;else for(;this.firstChild;)this.removeChild(this.firstChild);this.appendChild(this.loading)},t.prototype._renderResults=function(t){if(this.querySelector(".loading")&&this.removeChild(this.loading),t.detail&&void 0!==t.detail.results&&void 0===t.detail.invalid)this.addResults(t.detail.results);else{for(;this.firstChild;)this.removeChild(this.firstChild);this.appendChild(this.invalidMsg)}this.dispatchEvent(new CustomEvent("results-loaded",{detail:{results:this.results},bubbles:!0}))},t.prototype._clearResults=function(t){this.results=void 0},t.prototype._checkValid=function(t){var e=t.detail;this.valid=0<Object.keys(e.filters).length||null!==e.term&&""!==e.term&&void 0!==e.term,this.valid?this.querySelector(".invalidMsg")&&this.removeChild(this.invalidMsg):this.appendChild(this.invalidMsg)},t.prototype.addResults=function(t){if(t&&t.hits&&t.hits.hits){for(var e=t.hits.hits,s=e.length,i=0;i<s;i++)this.addResult(e[i]);this.last=this.last+s,this.last>=t.hits.total&&this.appendChild(this.endOfResults),0<s&&this.last<t.hits.total?(this.querySelector(".end-of-results")&&this.removeChild(this.endOfResults),this.appendChild(this.loadMore)):(this.querySelector(".moreBtn")&&this.removeChild(this.loadMore),this.appendChild(this.endOfResults))}},t}(HTMLElement),t("default",r),customElements.define("rhdp-search-results",r)}}});