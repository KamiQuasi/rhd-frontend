System.register(["../../@patternfly/pfelement/pfelement.js"],function(t,e){"use strict";var i,r,s,a=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});e&&e.id;return{setters:[function(t){r=t}],execute:function(){s=function(e){function r(){var t=e.call(this,r)||this;return t._uri=new URL(window.location.href),t._term=t.uri.searchParams.get("t"),t._filters=t._setFilters(t.uri.searchParams.getAll("f")),t._sort=t.uri.searchParams.get("s")||"relevance",t._qty=t.uri.searchParams.get("r"),t._init=!0,t._changeAttr=t._changeAttr.bind(t),t._popState=t._popState.bind(t),t}return a(r,e),Object.defineProperty(r.prototype,"html",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(r,"tag",{get:function(){return"dp-search-url"},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uri",{get:function(){return this._uri},set:function(t){this._uri!==t&&(this._uri=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"term",{get:function(){return this._term},set:function(t){this._term!==t&&(this._term=t,this.uri.searchParams.set("t",this._term),this.setAttribute("term",this.term))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"filters",{get:function(){return this._filters},set:function(t){var r=this;this._filters=t,this.uri.searchParams.delete("f"),this._filters.forEach(function(t,e){r.uri.searchParams.append("f",e+"~"+Array.from(t).reduce(function(t,e){return t+" "+e}))})},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sort",{get:function(){return this._sort},set:function(t){this._sort!==t&&(this._sort=t,this.uri.searchParams.set("s",this._sort),this.setAttribute("sort",this._sort))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"qty",{get:function(){return this._qty},set:function(t){this._qty!==t&&(this._qty=t,this.setAttribute("qty",this._sort))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"init",{get:function(){return this._init},set:function(t){this._init!==t&&(this._init=t)},enumerable:!0,configurable:!0}),r.prototype.connectedCallback=function(){e.prototype.connectedCallback.call(this),top.addEventListener("search-complete",this._changeAttr),top.addEventListener("clear-filters",this._changeAttr),top.window.addEventListener("popstate",this._popState),this._paramsReady()},Object.defineProperty(r,"observedAttributes",{get:function(){return["sort","term","qty"]},enumerable:!0,configurable:!0}),r.prototype.attributeChangedCallback=function(t,e,r){this[t]=r},r.prototype._getValueArray=function(t){},r.prototype._popState=function(t){this.uri=new URL(document.location.href),this.term=this.uri.searchParams.get("t")||null,this.filters=this._setFilters(this.uri.searchParams.getAll("f")),this.sort=this.uri.searchParams.get("s"),this.qty=this.uri.searchParams.get("r"),this._paramsReady()},r.prototype._paramsReady=function(){var t={detail:{term:this.term,filters:this.filters,sort:this.sort,qty:this.qty},bubbles:!0,composed:!0};this.dispatchEvent(new CustomEvent("params-ready",t))},r.prototype._setFilters=function(t){return new Map(t.map(function(t){return[t.split("~")[0],new Set(t.split("~")[1].split(" "))]}))},r.prototype._changeAttr=function(t){switch(t.type){case"clear-filters":this.uri.searchParams.delete("f"),this.filters.clear();break;case"load-more":break;case"search-complete":t.detail&&void 0!==t.detail.term&&0<t.detail.term.length?this.term=t.detail.term:(this.term="",this.uri.searchParams.delete("t")),t.detail&&t.detail.filters&&(this.filters=t.detail.filters),t.detail&&void 0!==t.detail.sort&&(this.sort=t.detail.sort)}t.detail&&void 0===t.detail.invalid?history.pushState({},"RHD Search: "+(this.term?this.term:""),""+this.uri.pathname+this.uri.search):(this.term="",this.filters.clear(),this.sort="relevance",this.uri.searchParams.delete("t"),this.uri.searchParams.delete("f"),this.uri.searchParams.delete("s"),history.replaceState({},"RHD Search Error",""+this.uri.pathname+this.uri.search))},r}(r.default),t("default",s),r.default.create(s)}}});